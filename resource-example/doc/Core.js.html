<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Core.js - Documentation</title><meta property="og:title" content=""/><meta property="og:type" content="website"/><meta property="og:image" content=""/><meta property="og:url" content=""/><script src="scripts/prettify/prettify.js"></script><script src="scripts/prettify/lang-css.js"></script><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="styles/prettify.css"><link type="text/css" rel="stylesheet" href="styles/jsdoc.css"><script src="scripts/nav.js" defer></script><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><input type="checkbox" id="nav-trigger" class="nav-trigger" /><label for="nav-trigger" class="navicon-button x"><div class="navicon"></div></label><label for="nav-trigger" class="overlay"></label><nav class="wrap"><input type="text" id="nav-search" placeholder="Search" /><h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ArrayExtd.html">ArrayExtd</a><ul class='methods'><li data-type='method' title='get of ArrayExtd'  style='display: none;'><a href="ArrayExtd.html#get">get</a></li></ul></li><li><a href="Cr.html">Cr</a><ul class='methods'><li data-type='method' title='dataSize of Cr'  style='display: none;'><a href="Cr.html#.dataSize">dataSize</a></li><li data-type='method' title='getFile of Cr'  style='display: none;'><a href="Cr.html#.getFile">getFile</a></li><li data-type='method' title='importScript of Cr'  style='display: none;'><a href="Cr.html#.importScript">importScript</a></li></ul></li><li><a href="cwui.html">cwui</a><ul class='members'><li data-type='member' style='display: none;'><a href="cwui.html#.activateKeyEvents">activateKeyEvents</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.customRoutines">customRoutines</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.fileCache">fileCache</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.imagesUrl">imagesUrl</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.pageTransition">pageTransition</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.resizables">resizables</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.trackedEvents">trackedEvents</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.transitions">transitions</a></li><li data-type='member' style='display: none;'><a href="cwui.html#.vKeyboard">vKeyboard</a></li></ul><ul class='methods'><li data-type='method' title='_AddEvent of cwui'  style='display: none;'><a href="cwui.html#._AddEvent">_AddEvent</a></li><li data-type='method' title='_ClearFingerActions of cwui'  style='display: none;'><a href="cwui.html#._ClearFingerActions">_ClearFingerActions</a></li><li data-type='method' title='_ClearImageFrameRate of cwui'  style='display: none;'><a href="cwui.html#._ClearImageFrameRate">_ClearImageFrameRate</a></li><li data-type='method' title='_eventExist of cwui'  style='display: none;'><a href="cwui.html#._eventExist">_eventExist</a></li><li data-type='method' title='_GetRoutine of cwui'  style='display: none;'><a href="cwui.html#._GetRoutine">_GetRoutine</a></li><li data-type='method' title='_InitNewPage of cwui'  style='display: none;'><a href="cwui.html#._InitNewPage">_InitNewPage</a></li><li data-type='method' title='_NeutralizePageEvents of cwui'  style='display: none;'><a href="cwui.html#._NeutralizePageEvents">_NeutralizePageEvents</a></li><li data-type='method' title='_performWhenAllImgsLoaded of cwui'  style='display: none;'><a href="cwui.html#._performWhenAllImgsLoaded">_performWhenAllImgsLoaded</a></li><li data-type='method' title='_prepareTransition of cwui'  style='display: none;'><a href="cwui.html#._prepareTransition">_prepareTransition</a></li><li data-type='method' title='_RemoveEvent of cwui'  style='display: none;'><a href="cwui.html#._RemoveEvent">_RemoveEvent</a></li><li data-type='method' title='_RemovePreviousPage of cwui'  style='display: none;'><a href="cwui.html#._RemovePreviousPage">_RemovePreviousPage</a></li><li data-type='method' title='_SetImageURL of cwui'  style='display: none;'><a href="cwui.html#._SetImageURL">_SetImageURL</a></li><li data-type='method' title='_Transition__cross_fade of cwui'  style='display: none;'><a href="cwui.html#._Transition__cross_fade">_Transition__cross_fade</a></li><li data-type='method' title='_Transition__fade_to_black of cwui'  style='display: none;'><a href="cwui.html#._Transition__fade_to_black">_Transition__fade_to_black</a></li><li data-type='method' title='addCustom of cwui'  style='display: none;'><a href="cwui.html#.addCustom">addCustom</a></li><li data-type='method' title='bindVKeyboard of cwui'  style='display: none;'><a href="cwui.html#.bindVKeyboard">bindVKeyboard</a></li><li data-type='method' title='cancelConnect of cwui'  style='display: none;'><a href="cwui.html#.cancelConnect">cancelConnect</a></li><li data-type='method' title='getById of cwui'  style='display: none;'><a href="cwui.html#.getById">getById</a></li><li data-type='method' title='onKeyDown of cwui'  style='display: none;'><a href="cwui.html#.onKeyDown">onKeyDown</a></li><li data-type='method' title='onKeyUp of cwui'  style='display: none;'><a href="cwui.html#.onKeyUp">onKeyUp</a></li><li data-type='method' title='registerElements of cwui'  style='display: none;'><a href="cwui.html#.registerElements">registerElements</a></li><li data-type='method' title='reloadStyleSheets of cwui'  style='display: none;'><a href="cwui.html#.reloadStyleSheets">reloadStyleSheets</a></li><li data-type='method' title='resizeAll of cwui'  style='display: none;'><a href="cwui.html#.resizeAll">resizeAll</a></li><li data-type='method' title='setInnerHTML of cwui'  style='display: none;'><a href="cwui.html#.setInnerHTML">setInnerHTML</a></li><li data-type='method' title='showDialog of cwui'  style='display: none;'><a href="cwui.html#.showDialog">showDialog</a></li><li data-type='method' title='userCallback of cwui'  style='display: none;'><a href="cwui.html#.userCallback">userCallback</a></li><li data-type='method' title='_BodyTransition of cwui'  style='display: none;'><a href="cwui.html#_BodyTransition">_BodyTransition</a></li></ul></li><li><a href="documentExtd.html">documentExtd</a><ul class='methods'><li data-type='method' title='transformXHTMLToDom of documentExtd'  style='display: none;'><a href="documentExtd.html#.transformXHTMLToDom">transformXHTMLToDom</a></li></ul></li><li><a href="FileCache.html">FileCache</a><ul class='methods'><li data-type='method' title='load of FileCache'  style='display: none;'><a href="FileCache.html#load">load</a></li></ul></li><li><a href="FingerActions.html">FingerActions</a><ul class='methods'><li data-type='method' title='Bind of FingerActions'  style='display: none;'><a href="FingerActions.html#Bind">Bind</a></li><li data-type='method' title='Clear of FingerActions'  style='display: none;'><a href="FingerActions.html#Clear">Clear</a></li></ul></li><li><a href="GenericCache.html">GenericCache</a><ul class='methods'><li data-type='method' title='get of GenericCache'  style='display: none;'><a href="GenericCache.html#get">get</a></li></ul></li><li><a href="HTMLElementExtd.html">HTMLElementExtd</a><ul class='members'><li data-type='member' style='display: none;'><a href="HTMLElementExtd.html#.innerXHTML">innerXHTML</a></li></ul><ul class='methods'><li data-type='method' title='appendChildNodes of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#appendChildNodes">appendChildNodes</a></li><li data-type='method' title='getJs of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#getJs">getJs</a></li><li data-type='method' title='getParentByCssSelector of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#getParentByCssSelector">getParentByCssSelector</a></li><li data-type='method' title='moveStyleSheet of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#moveStyleSheet">moveStyleSheet</a></li><li data-type='method' title='nextSiblingByCssSelector of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#nextSiblingByCssSelector">nextSiblingByCssSelector</a></li><li data-type='method' title='nextSiblingByTagName of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#nextSiblingByTagName">nextSiblingByTagName</a></li><li data-type='method' title='previousSiblingByCssSelector of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#previousSiblingByCssSelector">previousSiblingByCssSelector</a></li><li data-type='method' title='previousSiblingByTagName of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#previousSiblingByTagName">previousSiblingByTagName</a></li><li data-type='method' title='removeComments of HTMLElementExtd'  style='display: none;'><a href="HTMLElementExtd.html#removeComments">removeComments</a></li></ul></li><li><a href="ImageFrameRate.html">ImageFrameRate</a><ul class='methods'><li data-type='method' title='Clear of ImageFrameRate'  style='display: none;'><a href="ImageFrameRate.html#Clear">Clear</a></li><li data-type='method' title='Set of ImageFrameRate'  style='display: none;'><a href="ImageFrameRate.html#Set">Set</a></li></ul></li><li><a href="mainCwui.html">mainCwui</a><ul class='methods'><li data-type='method' title='_BodyTransition of mainCwui'  style='display: none;'><a href="mainCwui.html#_BodyTransition">_BodyTransition</a></li><li data-type='method' title='execCommand of mainCwui'  style='display: none;'><a href="mainCwui.html#execCommand">execCommand</a></li><li data-type='method' title='initWebSock of mainCwui'  style='display: none;'><a href="mainCwui.html#initWebSock">initWebSock</a></li></ul></li><li><a href="OverlayCanvas.html">OverlayCanvas</a><ul class='methods'><li data-type='method' title='circle of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#circle">circle</a></li><li data-type='method' title='circleAlpha of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#circleAlpha">circleAlpha</a></li><li data-type='method' title='clear of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#clear">clear</a></li><li data-type='method' title='path of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#path">path</a></li><li data-type='method' title='rectAlpha of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#rectAlpha">rectAlpha</a></li><li data-type='method' title='rectangle of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#rectangle">rectangle</a></li><li data-type='method' title='resize of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#resize">resize</a></li><li data-type='method' title='text of OverlayCanvas'  style='display: none;'><a href="OverlayCanvas.html#text">text</a></li></ul></li><li><a href="StringExtd.html">StringExtd</a><ul class='methods'><li data-type='method' title='isHTML of StringExtd'  style='display: none;'><a href="StringExtd.html#isHTML">isHTML</a></li><li data-type='method' title='splice of StringExtd'  style='display: none;'><a href="StringExtd.html#splice">splice</a></li></ul></li><li><a href="Vector.html">Vector</a><ul class='methods'><li data-type='method' title='Amplitude of Vector'  style='display: none;'><a href="Vector.html#Amplitude">Amplitude</a></li><li data-type='method' title='BaryCenter of Vector'  style='display: none;'><a href="Vector.html#BaryCenter">BaryCenter</a></li><li data-type='method' title='DotProd of Vector'  style='display: none;'><a href="Vector.html#DotProd">DotProd</a></li><li data-type='method' title='IsNull of Vector'  style='display: none;'><a href="Vector.html#IsNull">IsNull</a></li><li data-type='method' title='Normalize of Vector'  style='display: none;'><a href="Vector.html#Normalize">Normalize</a></li><li data-type='method' title='Substract of Vector'  style='display: none;'><a href="Vector.html#Substract">Substract</a></li></ul></li><li><a href="VirtualKeyboard.html">VirtualKeyboard</a><ul class='methods'><li data-type='method' title='Bind of VirtualKeyboard'  style='display: none;'><a href="VirtualKeyboard.html#Bind">Bind</a></li><li data-type='method' title='Map of VirtualKeyboard'  style='display: none;'><a href="VirtualKeyboard.html#Map">Map</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#autoReplaceVariables">autoReplaceVariables</a></li><li><a href="global.html#CWUI">CWUI</a></li><li><a href="global.html#dataSize">dataSize</a></li><li><a href="global.html#delegate">delegate</a></li><li><a href="global.html#downloadAsFile">downloadAsFile</a></li><li><a href="global.html#escapeHtml">escapeHtml</a></li><li><a href="global.html#getCustomStyles">getCustomStyles</a></li><li><a href="global.html#getMock">getMock</a></li><li><a href="global.html#loadFile">loadFile</a></li><li><a href="global.html#loadFileAsync">loadFileAsync</a></li><li><a href="global.html#replaceVariables">replaceVariables</a></li></ul></nav><div id="main"><h1 class="page-title">Core.js</h1><section><article><pre class="prettyprint source linenums"><code>/**
 * Created by jetbrains web development IDE ( Web/PhpStorm ).
 * Project: define-newElementHTML - spineNav
 * User: Pascal Gaudin
 * Mail: pascal.gaudin@zimmerbiomet.com
 * Date: 30/06/2021
 * Time: 19:04
 */

/**
 * class  Cr : the coreJs
 * @abstract
 * @classdesc Abstract class
 * @type {Cr}
 */
var Cr = class Cr {

	/**
	 * constructor
	 *
	 * @constructor
	 * @hideconstructor
	 */
	constructor() {
		if (this.constructor === Cr) {
			throw new TypeError('Abstract class "' + this.constructor.toString() +
								'" cannot be instantiated directly');
		}
	}

	/**
	 * Get a file in synchronous mode
	 *
	 * @param _path
	 * @param _binary
	 * @param _cbkDone
	 * @returns {boolean|any|string}
	 */
	static getFile(_path, _binary = false, _cbkDone = null) {
		const request = new XMLHttpRequest();
		var response = () => {
			return request.status == 404 ? false : (_binary ? request.response : request.responseText)
		};
		if (_binary)
			request.responseType = "arraybuffer";
		request.open("GET", _path, _cbkDone ? true : false);
		if (_cbkDone)
			request.onloadend = () => {
				_cbkDone(response());
			};
		request.send(null);
		return _cbkDone ? true : response();
	}

	/**
	 * Import a js Script and eval this
	 *
	 * @param _path
	 */
	static importScript(_path) {
		let code = Cr.getFile(_path);
		code = code.replace(/^[\u00BB\u00BF\uFEFF\t\r\n\v]+/gm, "");
		window.eval('\n' + code + ';');

	}

	/**
	 * Calcul data size in Kilo Byte,MegaByte ,etc.
	 *
	 * @param _a
	 * @param _b
	 * @returns {string}
	 */
	static dataSize(_a, _b = 2) {
		if (0 === _a)
			return "0B";
		const c = 0 > _b ? 0 : _b, d = Math.floor(Math.log(_a) / Math.log(1024));
		return parseFloat((_a / Math.pow(1024, d)).toFixed(c)) + ["B", "KB", "MB", "GB", "TB"][d];
	}
}


/*------------- we keep the olders functions, because they are certainly used elsewhere --------------------------------*/
/**
 * Synchronous or asynchronous file load
 *
 * @param _path
 * @param _binary
 * @param _onLoadEnd
 * @returns {*}
 */
function loadFile(_path, _binary = false, _onLoadEnd = null) {
	return Cr.getFile(_path, _binary, _onLoadEnd);
}


/**
 * Async loadFile, using a promise
 *
 * @async
 * @param _path
 * @param _binary
 * @returns {Promise&lt;unknown>}
 */
async function loadFileAsync(_path, _binary = false) {
	return await new Promise((_resolve) => {
		Cr.getFile(_path, _binary, _response => {
			_resolve(_response);
		});
	});
}


/**
 * Replace data tokens using replacement pairs
 *
 * @param _data
 * @param _replacementPairs
 * @returns {*}
 */
function replaceVariables(_data, _replacementPairs) {
	_replacementPairs.forEach((_replacementPair) => {
		_data = _data.split("$" + _replacementPair[0]).join(_replacementPair[1]);
	});
	return _data;
}


/**
 * Replace data tokens using smart automatic parsing
 *
 * @param _data
 * @param _object
 * @returns {*}
 */
function autoReplaceVariables(_data, _object) {
	[..._data.matchAll(/\$(\w*)/g)].forEach((_token) => {
		_data = _data.split("$" + _token[1]).join(_object[_token[1]]);
	});
	return _data;
}


/**
 *  Delegate call
 * @async
 * @param _fn
 * @param _delay
 */
function delegate(_fn, _delay = 0) {
	setTimeout(_fn, _delay);
}


/**
 * Format data size by adding extension
 *
 * @param _a
 * @param _b
 */
function dataSize(_a, _b = 2) {
	Cr.dataSize(_a, _b = 2)
}


/**
 * Escape HTML data
 *
 * @param _data
 * @returns {*}
 */
function escapeHtml(_data) {
	return _data.replace(/&amp;/g, "&amp;amp;").replace(/&lt;/g, "&amp;lt;").replace(/>/g, "&amp;gt;").replace(/"/g, "&amp;quot;").replace(/'/g, "&amp;#039;");
}


/**
 * Get custom styles from a given class name
 *
 * @param _className
 * @param _properties
 * @returns {{}}
 */
function getCustomStyles(_className, _properties) {
	var telement = document.createElement("div");
	telement.classList.add(_className);
	document.body.appendChild(telement);
	var style = {};
	_properties.forEach((_property) => {
		style[_property] = window.getComputedStyle(telement, null).getPropertyValue("--" + _property).trim();
	});
	telement.remove();
	return style;
}

/**
 * Download a Uint8Array as a file
 *
 * @param _data
 * @param _filename
 * @param _type
 */
function downloadAsFile(_data, _filename, _type = "application/octet-stream") {
	var file = new Blob([_data], {type: _type});
	var a = document.createElement("a");
	var url = URL.createObjectURL(file);
	a.href = url;
	a.download = _filename;
	document.body.appendChild(a);
	a.click();
	setTimeout(() => {
		document.body.removeChild(a);
		window.URL.revokeObjectURL(url);
	}, 0);
}


/**
 * get a mock in JSON
 *
 *  not used
 * @todo improvement ...
 * @async
 * @param nameMock
 * @returns {Promise&lt;*>}
 */
async function getMock(nameMock) {
	var _params = await loadFileAsync("asset/mock/" + nameMock + "[0].json");
	var json = JSON.parse(_params);
	return json[nameMock];

}

/*********************************************************************/
/** other methods :
 *
 	static getFile( file , _binary = false, _onLoadEnd = false ) {
		var page = file.split(/\//).pop();
		const request = new XMLHttpRequest();
		var wait = setTimeout( ()=>{
			request.abort();
			throw new Error("Time out load js : "+page +"!")},2500);


		if( _binary ) request.responseType = "arraybuffer";
		              request.open("GET", file, _onLoadEnd ? true : false);
					  request.send();

		var res= ()=>{
			clearTimeout(wait);
			if(request.status == 404 )  throw "Page "+ page +" not found !";
			var response = _binary ? request.response : request.responseText;
			request.abort();
			return  response;
		} ;
		if( _onLoadEnd ) request.onloadend = ()=>  _onLoadEnd.call(null,res.call()); else
            return res.call();
 			return true;
	}
 */

</code></pre></article></section></div><br class="clear"><footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sat Sep 04 2021 10:29:09 GMT+0200 (heure d’été d’Europe centrale) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer><script>prettyPrint();</script><script src="scripts/polyfill.js"></script><script src="scripts/linenumber.js"></script><script src="scripts/search.js" defer></script><script src="scripts/collapse.js" defer></script></body></html>
